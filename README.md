# Packet-Software
Simple software for sending packets from Windows server to a Windows client all why tracking it.
I want to create a very simple, basic software on my server ncterry-server1 that through a very simple action sends packets to the client ncterry-client1. Can you give me an example and the code  

For a straightforward example, let's create a basic .NET console application on your server (ncterry-server1) that sends a simple message to the client (ncterry-client1) using TCP. This example involves writing a TCP client (on the server machine) and a corresponding TCP listener (on the client machine) that waits for incoming connections and messages. 
################################################################# 
################################################################# 

Creating a new Console Application in Visual Studio involves a series of steps from launching Visual Studio to writing and running your first piece of code. Here's a detailed guide: 

Step 1: Open Visual Studio 
Launch Visual Studio from your Start menu, desktop, or taskbar. 

Step 2: Create a New Project 
On the Visual Studio start window, select "Create a new project." If Visual Studio is already open, you can find this option under the "File" menu by choosing "New" > "Project." 

Step 3: Choose the Project Type 
In the "Create a new project" window, you’ll see a list of project templates. 

Type “console” into the search box to filter the list. 
Select "Console App" from the list. Make sure to choose the one that matches your development language preference (e.g., "Console App (.NET Core)" for C#). 

Click "Next." 

Step 4: Configure Your New Project 
On the next screen, you will be asked to configure your new project. 
Project Name: Enter a name for your project in the "Project name" field. 
Location: Choose where you would like to save your project. 
Solution Name: By default, this matches your project name but can be changed if you wish. 
For .NET projects, you can also choose the target framework from a dropdown menu. If you're unsure, go with the default selection, which is usually the latest stable version. 
Click "Create." 

Step 5: Writing Code 
After creating the project, Visual Studio opens up the main code file for your new console application. By default, this file is named Program.cs for C# applications. 
You’ll see some default code generated by Visual Studio. For a C# application, it looks something like this: 
################################################################# 
################################################################# 
<pre>
using System; 
namespace YourProjectName 
{ 
    class Program 
    { 
        static void Main(string[] args) 

        { 
            Console.WriteLine("Hello World!"); 
        } 
    } 
} 
</pre>
################################################################# 
################################################################# 

This basic program will print "Hello World!" to the console when run. 

Step 6: Running Your Application 
To run your application, click on the green "Start" button in the toolbar at the top of the Visual Studio window, or press F5. This will compile and run your application. 
A console window should open displaying "Hello World!" or any other messages you’ve coded it to display. 
The console window may close immediately after displaying the message, depending on your Visual Studio settings. To keep it open, you can add a Console.ReadLine(); statement at the end of your Main method, which will wait for you to press Enter before closing. 

Step 7: Saving and Closing 
To save your work, you can use the shortcut Ctrl+S to save the current file, or Ctrl+Shift+S to save all open files and the project. 
You can close the project by choosing "File" > "Close Solution" or exit Visual Studio entirely by selecting "File" > "Exit." 
This process creates a basic console application that you can now develop further by adding more code according to your project needs. 

################################################################# 
################################################################# 

Part 1: TCP Listener on ncterry-client1 (Windows 11 Client) 
First, you'll set up the TCP listener on the client to accept incoming messages. Create a new Console Application in Visual Studio and paste the following code: 
################################################################# 
################################################################# 
<pre>
using System; 
using System.Net; 
using System.Net.Sockets; 
using System.Text; 
namespace TcpListenerExample 

{ 
    class Program 

    { 
        static void Main(string[] args) 

        { 
            int port = 13000; // Port number for the TCP listener 
            IPAddress localAddr = IPAddress.Parse("127.0.0.1"); 

            // TcpListener to accept incoming TCP connection requests. 
            TcpListener server = new TcpListener(localAddr, port); 

            // Start listening for client requests. 
            server.Start(); 

            Console.WriteLine("Waiting for a connection... "); 

            // Perform a blocking call to accept requests. 
            // You could also use server.AcceptTcpClientAsync() for an asynchronous version. 
            TcpClient client = server.AcceptTcpClient(); 
            Console.WriteLine("Connected!"); 

            // Get a stream object for reading and writing 
            NetworkStream stream = client.GetStream(); 

            // Buffer for reading data 
            Byte[] bytes = new Byte[256]; 
            String data = null; 
  
            // Loop to receive all the data sent by the client. 
            int i; 
            while((i = stream.Read(bytes, 0, bytes.Length))!=0) 

            {    
                // Translate data bytes to a ASCII string. 
                data = System.Text.Encoding.ASCII.GetString(bytes, 0, i); 
                Console.WriteLine("Received: {0}", data); 

                 
                // Process the data sent by the client. 
                data = data.ToUpper(); 

                byte[] msg = System.Text.Encoding.ASCII.GetBytes(data); 

                // Send back a response. 
                stream.Write(msg, 0, msg.Length); 
                Console.WriteLine("Sent: {0}", data);             

            } 
  
            // Shutdown and end connection 
            client.Close(); 
            server.Stop(); 

        } 
    } 
} 
</pre>

################################################################# 
################################################################# 

This code snippet creates a TCP listener on ncterry-client1 that listens for connections on port 13000. Adjust the IPAddress.Parse("127.0.0.1") line to match the client's local IP address or use IPAddress.Any to listen on all network interfaces. 


Part 2: TCP Client on ncterry-server1 (Windows Server 2022) 
Next, create the TCP client application that will run on the server. This application will connect to the listener on the client and send a message. In a new Console Application project in Visual Studio, paste the following code: 

################################################################# 
################################################################# 
<pre>
using System; 
using System.Net.Sockets; 
using System.Text; 
namespace TcpClientExample 

{ 
    class Program 

    { 
        static void Main(string[] args) 

        { 
            try 

            { 
                // Establish the remote endpoint for the socket. 
                // This example uses port 13000 on the local computer. 
                int port = 13000; 
                TcpClient client = new TcpClient("ncterry-client1", port); 

                // Translate the passed message into ASCII and store it as a byte array. 
                string message = "Hello from ncterry-server1"; 
                byte[] data = Encoding.ASCII.GetBytes(message); 

                // Get the stream for writing to the connection 
                NetworkStream stream = client.GetStream(); 

                // Send the message to the connected TcpServer. 
                stream.Write(data, 0, data.Length); 
                Console.WriteLine("Sent: {0}", message); 

                // Receive the TcpServer.response. 
                // Buffer to store the response bytes. 
                data = new byte[256]; 

                // String to store the response ASCII representation. 
                string responseData = string.Empty; 

                // Read the first batch of the TcpServer response bytes. 
                int bytes = stream.Read(data, 0, data.Length); 
                responseData = Encoding.ASCII.GetString(data, 0, bytes); 
                Console.WriteLine("Received: {0}", responseData); 

                // Close everything. 
                stream.Close(); 
                client.Close(); 

            } 

            catch (ArgumentNullException e) 

            { 
                Console.WriteLine("ArgumentNullException: {0}", e); 

            } 
            catch (SocketException e) 

            { 
                Console.WriteLine("SocketException: {0}", e); 

            } 

            Console.WriteLine("\n Press Enter to continue..."); 
            Console.Read(); 

        } 
    } 
} 

</pre>

################################################################# 
################################################################# 

This code snippet attempts to connect to the TCP listener on ncterry-client1 at port 13000 and sends a simple message. Replace "ncterry-client1" with the actual IP address or hostname of your Windows 11 client. 

 
Running the Applications 
On ncterry-client1: Run the TCP Listener application first. It will wait for incoming connections. 
On ncterry-server1: Run the TCP Client application. It will connect to the listener and send the message. 

 
Tracking the Packet with pktmon 
After setting up the TCP client and listener, use pktmon on the client to monitor TCP packets on port 13000. Start pktmon filtering by port before running the client application: 

 
################################################################# 
################################################################# 

  pktmon start --etw -p 13000 -c 

################################################################# 
################################################################# 

After running the applications, stop pktmon and convert the logs to check for the captured packets. 
This setup demonstrates a basic TCP communication between a server and a client, along with monitoring the specific communication using pktmon. 

################################################################# 
################################################################# 
